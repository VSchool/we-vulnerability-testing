const { expressjwt } = require('express-jwt');

const log = (req, res, next) => {
    console.log(req.method, req.url, req.body);
    next()
}

const errorHandler = (error, req, res, next) => {
    res.send({ success: false, error });
}

const verifyAccessToken = () => {
    return expressjwt({ secret: process.env.SECRET, algorithms: ['HS256'] })
}

module.exports = {
    log,
    errorHandler,
    verifyAccessToken
}